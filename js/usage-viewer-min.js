function getJsonFromUrl(){var t=location.search.substr(1),s={};return t.split("&").forEach(function(t){var a=t.split("=");s[a[0]]=decodeURIComponent(a[1])}),s}window.UsageViewer={args:{},months:[],month:"",smonth:"",formats:{},sformats:{},format:"",cutline:null,poke:null,stats:{},pokedata:null,init:function(){NavigationBar.setLoading(),this.args=getJsonFromUrl(),"collapsed"===this.args.nbar&&NavigationBar.hide(),Tools.wget("./data/months.json",function(t){"string"==typeof t&&(t=JSON.parse(t)),this.months=t.list,NavigationBar.setMonths(this.months),this.month=this.months[this.months.length-1],this.args.month&&this.months.indexOf(this.args.month)>=0&&(this.month=this.args.month),this.smonth=this.month,NavigationBar.setSelectedMonth(this.month),this.loadMonth(function(){this.loadPage(function(){NavigationBar.setLoading(!1)},this.args)}.bind(this),this.args)}.bind(this))},loadMonth:function(t,s){Tools.wget("./data/months/"+this.month+"/formats.json",function(a){if("string"==typeof a&&(a=JSON.parse(a)),this.formats=a,this.sformats=a,NavigationBar.setFormats(this.formats),s&&s.format&&(this.format=toId(s.format)),this.format&&this.formats[this.format]||(this.format="gen7ou"),!this.formats[this.format])for(var e in this.formats){this.format=e;break}return NavigationBar.setSelectedFormat(this.format),NavigationBar.setCutlines(this.formats[this.format]),s&&s.cut&&(this.cutline=parseInt(s.cut)),null!==this.cutline&&this.formats[this.format].cuts.indexOf(this.cutline)!==-1||(this.cutline=this.formats[this.format].dcut),NavigationBar.setSelectedCutline(this.cutline),t()}.bind(this))},loadPage:function(t,s){var a="./data/months/"+this.month+"/formats/"+this.format+"/"+this.cutline+"/ranking.json";Tools.wget(a,function(a){return"string"==typeof a&&(a=JSON.parse(a)),this.stats=a,s&&s.pokemon&&(this.poke=toId(s.pokemon)),null===this.poke?(this.showPokemonList(),t()):void this.loadPokemonData(function(){return this.showPokemonDetail(),t()}.bind(this))}.bind(this))},loadPokemonData:function(t){var s="./data/months/"+this.month+"/formats/"+this.format+"/"+this.cutline+"/pokedata.json";Tools.wget(s,function(s){return"string"==typeof s&&(s=JSON.parse(s)),this.pokedata=s,t()}.bind(this))},reloadPage:function(t,s,a,e,d){if(t&&this.months.indexOf(t)==-1&&(t=this.months[this.months.length-1]),t&&t!==this.month)this.month=t,this.smonth=t,NavigationBar.setSelectedMonth(this.month),Tools.wget("./data/months/"+this.month+"/formats.json",function(t){if("string"==typeof t&&(t=JSON.parse(t)),this.formats=t,this.sformats=t,NavigationBar.setFormats(this.formats),s&&(this.format=s),this.format&&this.formats[this.format]||(this.format="gen7ou"),!this.formats[this.format])for(var o in this.formats){this.format=o;break}NavigationBar.setSelectedFormat(this.format),NavigationBar.setCutlines(this.formats[this.format]),null!==a&&(this.cutline=a),null!==this.cutline&&this.formats[this.format].cuts.indexOf(this.cutline)!==-1||(this.cutline=this.formats[this.format].dcut),NavigationBar.setSelectedCutline(this.cutline),(e||null===e)&&(this.poke=e),this.pokedata=null,this.loadPage(function(){return d()})}.bind(this));else if(!s||s===this.format&&t!==!1)if(null!==a&&a!==this.cutline)this.cutline=a,null!==this.cutline&&this.formats[this.format].cuts.indexOf(this.cutline)!==-1||(this.cutline=this.formats[this.format].dcut),NavigationBar.setSelectedCutline(this.cutline),(e||null===e)&&(this.poke=e),this.pokedata=null,this.loadPage(function(){return d()});else{if(!e&&null!==e||e===this.poke)return d();if(this.poke=e,null===this.poke)return this.showPokemonList(),d();this.loadPokemonData(function(){return this.showPokemonDetail(),d()}.bind(this))}else{if(this.format=s,this.format&&this.formats[this.format]||(this.format="gen7ou"),!this.formats[this.format])for(var o in this.formats){this.format=o;break}NavigationBar.setSelectedFormat(this.format),NavigationBar.setCutlines(this.formats[this.format]),null!==a&&(this.cutline=a),null!==this.cutline&&this.formats[this.format].cuts.indexOf(this.cutline)!==-1||(this.cutline=this.formats[this.format].dcut),NavigationBar.setSelectedCutline(this.cutline),(e||null===e)&&(this.poke=e),this.pokedata=null,this.loadPage(function(){return d()})}},reloadNavBar:function(t,s){return t&&this.months.indexOf(t)==-1&&(t=this.months[this.months.length-1]),t&&t!==this.smonth?(this.smonth=t,void Tools.wget("./data/months/"+this.smonth+"/formats.json",function(t){"string"==typeof t&&(t=JSON.parse(t)),this.sformats=t;var a=NavigationBar.getSelectedFormat();if(NavigationBar.setFormats(this.sformats),a&&this.sformats[a]||(a="gen7ou"),!this.sformats[a])for(var e in this.sformats){a=e;break}NavigationBar.setSelectedFormat(a);var d=NavigationBar.getSelectedCutline();return NavigationBar.setCutlines(this.sformats[a]),null!==d&&this.sformats[a].cuts.indexOf(d)!==-1||(d=this.sformats[a].dcut),NavigationBar.setSelectedCutline(d),s()}.bind(this))):s()},onChangeSelectedMonth:function(){var t=NavigationBar.getSelectedMonth();t!==this.smonth&&(NavigationBar.setLoading(),this.reloadNavBar(t,function(){NavigationBar.setLoading(!1)}))},onChangeSelectedFormat:function(){var t=NavigationBar.getSelectedFormat(),s=NavigationBar.getSelectedCutline();NavigationBar.setCutlines(this.sformats[t]),null!==s&&this.sformats[t].cuts.indexOf(s)!==-1||(s=this.sformats[t].dcut),NavigationBar.setSelectedCutline(s)},viewStats:function(){NavigationBar.setLoading(),this.month=this.smonth,this.formats=this.sformats,this.reloadPage(!1,NavigationBar.getSelectedFormat(),NavigationBar.getSelectedCutline(),this.poke,function(){window.history.pushState({},null,this.getPokeHref(this.poke)),NavigationBar.setLoading(!1)}.bind(this))},getPokeHref:function(t){return t?"?month="+this.month+"&format="+this.format+"&cut="+this.cutline+"&pokemon="+t:"?month="+this.month+"&format="+this.format+"&cut="+this.cutline},showPokemonList:function(){var t="";t+='<h1 class="title-format">'+Tools.getFormatName(this.format)+"</h1>",t+='<h2 class="subtitle">'+Tools.getMonthName(this.month)+"</h2>",t+='<h2 class="subtitle">Cutline: '+this.cutline+"</h2>",t+="<p><b>Total Battles:</b> "+this.stats.battles+"</p>",t+="<p><b>Avg. weight/team:</b> "+Tools.decimalFormat(this.stats.avg,3)+"</p>",t+='<div align="center">',t+='<table class="usage-table" border="0">',t+='<tr class="tr-head"><td>#</td><td>Pokemon</td><td>Usage %</td><td>Raw</td><td class="expendable">Raw %</td>',t+='<td class="expendable">Real</td><td class="expendable">Real %</td></tr>';for(var s,a=0;a<this.stats.pokemon.length;a++)s=this.stats.pokemon[a],t+="<tr>",t+='<td class="td-bold">'+(a+1)+"</td>",t+="<td>"+Tools.getMiniSprite(toId(s.name))+' <a name="pokemon-link" value="'+toId(s.name)+'" class="poke-link" href="'+this.getPokeHref(toId(s.name))+'">',t+=escapeHTML(s.name)+"</a></td>",t+='<td class="td-bold">'+Tools.decimalFormat(s.usage,2,2)+" %</td>",t+="<td>"+s.raw+"</td>",t+='<td class="expendable">'+Tools.decimalFormat(s.rawp,2,2)+"%</td>",t+='<td class="expendable">'+s.real+"</td>",t+='<td class="expendable">'+Tools.decimalFormat(s.realp,2,2)+"%</td>",t+="</tr>";t+="</table>",t+="</div>",this.setHTML(t)},getPokemonDetail:function(t){if(!t)return null;for(var s=null,a=0,e=0;e<this.stats.pokemon.length;e++)if(toId(this.stats.pokemon[e].name)===t){s=this.stats.pokemon[e],a=e;break}return s?{pos:e+1,usage:s,data:this.pokedata[t]}:null},showPokemonDetail:function(){var t="",s=this.getPokemonDetail(this.poke);if(t+='<h1 class="title-format">'+Tools.getFormatName(this.format)+"</h1>",t+='<h2 class="subtitle">'+Tools.getMonthName(this.month)+"</h2>",t+='<h2 class="subtitle">Cutline: '+this.cutline+"</h2>",!s)return t+='<div align="center"><h1>Not Found: &quot;'+escapeHTML(this.poke)+"&quot;</h1></div>",t+='<p class="poke-option-link"><a name="back-link" href="'+this.getPokeHref(null)+'">&lt;&lt; Back to the pokemon list</a></p>',t+='<hr width="100%" />',void this.setHTML(t);if(t+='<div align="center"><img class="poke-sprite" src="'+Tools.getPokemonSprite(s.usage.name)+'" width="120" height="120" /></div>',t+='<p class="poke-option-link"><a name="back-link" href="'+this.getPokeHref(null)+'">&lt;&lt; Back to the pokemon list</a></p>',t+='<h2 class="poke-title">#'+s.pos+", "+escapeHTML(s.usage.name)+"</h2>",t+='<p class="poke-option-link" style="text-align:right;"><a href="http://dex.pokemonshowdown.com/pokemon/'+this.poke+'" target="_blank">Go to the Pokedex</a></p></div>',t+='<hr width="100%" />',t+='<table class="usage-table" border="0">',t+='<tr class="tr-head"><td>Usage %</td><td>Raw</td><td>Raw %</td><td>Real</td><td>Real %</td></tr>',t+='<tr><td class="td-bold">'+Tools.decimalFormat(s.usage.usage,3,3)+" %</td>",t+="<td>"+s.usage.raw+"</td>",t+="<td>"+Tools.decimalFormat(s.usage.rawp,3,3)+"%</td>",t+="<td>"+s.usage.real+"</td>",t+="<td>"+Tools.decimalFormat(s.usage.realp,3,3)+"%</td></tr>",t+="</table>",t+='<table class="usage-table alt-table-color" border="0">',t+='<tr class="tr-head"><td>Most Used Abilities</td><td class="usage-percent-td">%</td></tr>',s.data&&0!==s.data.abilities.length)for(var a=0;a<s.data.abilities.length;a++)t+='<tr><td class="td-bold">'+escapeHTML(s.data.abilities[a].name)+'</td><td class="usage-percent-td">'+Tools.decimalFormat(s.data.abilities[a].usage,2,2)+"%</td></tr>";else t+='<tr><td class="td-bold">-</td><td class="usage-percent-td">-</td></tr>';if(t+="</table>",t+='<table class="usage-table" border="0">',t+='<tr class="tr-head"><td>Most Used Moves</td><td class="usage-percent-td">%</td></tr>',s.data&&0!==s.data.moves.length)for(var a=0;a<s.data.moves.length;a++)t+='<tr><td class="td-bold">'+escapeHTML(s.data.moves[a].name)+'</td><td class="usage-percent-td">'+Tools.decimalFormat(s.data.moves[a].usage,2,2)+"%</td></tr>";else t+='<tr><td class="td-bold">-</td><td class="usage-percent-td">-</td></tr>';if(t+="</table>",t+='<table class="usage-table alt-table-color" border="0">',t+='<tr class="tr-head"><td>Most Used Items</td><td class="usage-percent-td">%</td></tr>',s.data&&0!==s.data.items.length)for(var a=0;a<s.data.items.length;a++)t+='<tr><td class="td-bold">'+escapeHTML(s.data.items[a].name)+'</td><td class="usage-percent-td">'+Tools.decimalFormat(s.data.items[a].usage,2,2)+"%</td></tr>";else t+='<tr><td class="td-bold">-</td><td class="usage-percent-td">-</td></tr>';if(t+="</table>",t+='<table id="spreads-table" class="usage-table" border="0">',t+='<tr class="tr-head"><td>Most Used Spreads</td><td class="stat-td">HP</td><td class="slash-td">/</td><td class="stat-td">Atk</td><td class="slash-td">/</td><td class="stat-td">Def</td><td class="slash-td">/</td><td class="stat-td">SpA</td><td class="slash-td">/</td><td class="stat-td">SpD</td><td class="slash-td">/</td><td class="stat-td">Spe</td><td class="usage-percent-td">%</td></tr>',s.data&&0!==s.data.spreads.length)for(var a=0;a<s.data.spreads.length;a++)t+='<tr><td class="td-bold">'+escapeHTML(s.data.spreads[a].nature)+"</td>",t+='<td class="stat-td">'+(null===s.data.spreads[a].evs.hp?"?":s.data.spreads[a].evs.hp||"0")+'</td><td class="slash-td">/</td>',t+='<td class="stat-td">'+(null===s.data.spreads[a].evs.atk?"?":s.data.spreads[a].evs.atk||"0")+'</td><td class="slash-td">/</td>',t+='<td class="stat-td">'+(null===s.data.spreads[a].evs.def?"?":s.data.spreads[a].evs.def||"0")+'</td><td class="slash-td">/</td>',t+='<td class="stat-td">'+(null===s.data.spreads[a].evs.spa?"?":s.data.spreads[a].evs.spa||"0")+'</td><td class="slash-td">/</td>',t+='<td class="stat-td">'+(null===s.data.spreads[a].evs.spd?"?":s.data.spreads[a].evs.spd||"0")+'</td><td class="slash-td">/</td>',t+='<td class="stat-td">'+(null===s.data.spreads[a].evs.spe?"?":s.data.spreads[a].evs.spe||"0")+"</td>",t+='<td class="usage-percent-td">'+Tools.decimalFormat(s.data.spreads[a].usage,2,2)+"%</td></tr>";else t+='<tr><td class="td-bold">-</td>',t+='<td class="stat-td">-</td><td class="slash-td">/</td>',t+='<td class="stat-td">-</td><td class="slash-td">/</td>',t+='<td class="stat-td">-</td><td class="slash-td">/</td>',t+='<td class="stat-td">-</td><td class="slash-td">/</td>',t+='<td class="stat-td">-</td><td class="slash-td">/</td>',t+='<td class="stat-td">-</td>',t+='<td class="usage-percent-td">-</td></tr>';if(t+="</table>",t+='<table id="spreads-table-min" class="usage-table" border="0">',t+='<tr class="tr-head"><td>Most Used Spreads</td><td class="usage-percent-td">%</td></tr>',s.data&&0!==s.data.spreads.length)for(var a=0;a<s.data.spreads.length;a++)t+='<tr><td class="td-bold">'+escapeHTML(s.data.spreads[a].nature),t+=" "+(null===s.data.spreads[a].evs.hp?"?":s.data.spreads[a].evs.hp||"0")+" / ",t+=(null===s.data.spreads[a].evs.atk?"?":s.data.spreads[a].evs.atk||"0")+" / ",t+=(null===s.data.spreads[a].evs.def?"?":s.data.spreads[a].evs.def||"0")+" / ",t+=(null===s.data.spreads[a].evs.spa?"?":s.data.spreads[a].evs.spa||"0")+" / ",t+=(null===s.data.spreads[a].evs.spd?"?":s.data.spreads[a].evs.spd||"0")+" / ",t+=(null===s.data.spreads[a].evs.spe?"?":s.data.spreads[a].evs.spe||"0")+"</td>",t+='<td class="usage-percent-td">'+Tools.decimalFormat(s.data.spreads[a].usage,2,2)+"%</td></tr>";else t+='<tr class="tr-head"><td class="td-bold">-</td><td class="usage-percent-td">-</td></tr>';if(t+="</table>",t+='<table class="usage-table alt-table-color" border="0">',t+='<tr class="tr-head"><td>Most Common Teammates</td><td class="usage-percent-td">%</td></tr>',s.data&&0!==s.data.teammates.length)for(var a=0;a<s.data.teammates.length;a++)t+='<tr><td class="td-bold">'+Tools.getMiniSprite(toId(s.data.teammates[a].name))+'<a name="pokemon-link" class="poke-link" href="'+this.getPokeHref(toId(s.data.teammates[a].name))+'">'+escapeHTML(s.data.teammates[a].name)+'</a></td><td class="usage-percent-td">'+Tools.decimalFormat(s.data.teammates[a].usage,2,2)+"%</td></tr>";else t+='<tr><td class="td-bold">-</td><td class="usage-percent-td">-</td></tr>';if(t+="</table>",t+='<table class="usage-table" border="0">',t+='<tr class="tr-head"><td>Most Common Checks / Counters</td><td class="usage-percent-td">% Switch</td><td class="usage-percent-td">% KO</td><td class="usage-percent-td">% Total</td></tr>',s.data&&0!==s.data.counters.length)for(var a=0;a<s.data.counters.length;a++)t+='<tr><td class="td-bold">'+Tools.getMiniSprite(toId(s.data.counters[a].name))+'<a name="pokemon-link" class="poke-link" href="'+this.getPokeHref(toId(s.data.counters[a].name))+'">'+escapeHTML(s.data.counters[a].name)+"</a></td>",t+='<td class="usage-percent-td">'+Tools.decimalFormat(s.data.counters[a].ko,2,2)+"%</td>",t+='<td class="usage-percent-td">'+Tools.decimalFormat(s.data.counters[a].sw,2,2)+"%</td>",t+='<td class="usage-percent-td">'+Tools.decimalFormat(s.data.counters[a].eff,2,2)+"%</td>",t+="</tr>";else t+='<tr><td class="td-bold">-</td><td class="usage-percent-td">-</td><td class="usage-percent-td">-</td><td class="usage-percent-td">-</td></tr>';t+="</table>",t+='<table class="usage-table alt-table-color" border="0">',t+='<tr class="tr-head"><td>Lead (When Used)</td><td>Lead (All Games)</td></tr>',s.data&&s.data.lead?(t+=0===s.usage.usage?'<tr><td class="td-bold">-</td>':'<tr><td class="td-bold">'+Tools.decimalFormat(s.data.lead.usage/s.usage.usage*100,3,3)+"%</td>",t+='<td class="td-bold">'+Tools.decimalFormat(s.data.lead.usage,3,3)+"%</td></tr>"):(t+='<tr><td class="usage-percent-td">-</td>',t+='<td class="usage-percent-td">-</td></tr>'),t+="</table>",t+='<table class="usage-table" border="0">',t+='<tr class="tr-head"><td>Raw Count</td><td>Avg. weight</td><td>Viability Ceiling</td></tr>',s.data?(t+="<tr><td>"+s.data.raw+"</td>",t+="<td>"+s.data.avg+"</td>",t+="<td>"+s.data.vc+"</td></tr>"):t+="<tr><td>-</td><td>-</td><td>-</td></tr>",t+="</table>",this.setHTML(t)},setHTML:function(t){$("#main-container").html(t),document.body.scrollTop=0,window.pageYOffset=0}};